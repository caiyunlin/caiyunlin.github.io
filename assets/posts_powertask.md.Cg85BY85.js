import{_ as i,c as a,o as e,ah as n}from"./chunks/framework.ytAaTfF9.js";const g=JSON.parse('{"title":"在线的PowerShell类库 - PowerTask","description":"PowerTask 是一个在线的 PowerShell 功能库，将通用的 PowerShell 脚本封装成在线功能模块，只需一行代码即可远程加载最新版本的实用工具","frontmatter":{"title":"在线的PowerShell类库 - PowerTask","date":"2016-12-01T11:37:45.000Z","category":"技术","tags":["powershell"],"urlname":"powertask","url":"https://www.caiyunlin.com/posts/powertask/","description":"PowerTask 是一个在线的 PowerShell 功能库，将通用的 PowerShell 脚本封装成在线功能模块，只需一行代码即可远程加载最新版本的实用工具"},"headers":[],"relativePath":"posts/powertask.md","filePath":"posts/powertask.md"}'),l={name:"posts/powertask.md"};function t(p,s,h,k,r,o){return e(),a("div",null,[...s[0]||(s[0]=[n(`<p>在公司的项目中，写了大量的PowerShell脚本去安装软件和部署新的Release，偶尔也会分享PowerShell脚本给其他Team的同事。<br> 闲暇之余，研究了一下，发现只要打开权限，PowerShell也有远程下载执行脚本并且执行的功能，遂产生一个念头，如果将通用的PowerShell脚本封装成在线的功能库，然后本地只用一行脚本载入一下，这样不是能很好的复用了吗？ 而且可以实时载入最新的版本，那不是很快活。</p><p>说干就干，在GitHub上面开了项目，暂且命名为 PowerTask，地址 <a href="https://github.com/cylin2000/powertask" target="_blank" rel="noreferrer">https://github.com/cylin2000/powertask</a></p><h2 id="主要功能" tabindex="-1">主要功能 <a class="header-anchor" href="#主要功能" aria-label="Permalink to &quot;主要功能&quot;">​</a></h2><ol><li><p>用管理员模式打开PowerShell</p></li><li><p>如果你是第一次使用PowerShell，输入以下命令，打开脚本执行权限（执行一次即可，后面再打开不需要重复执行）</p></li></ol><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Set-ExecutionPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bypass</span></span></code></pre></div><ol start="3"><li>复制粘贴，执行以下命令</li></ol><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iex (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">new-object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> net.webclient).downloadstring(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https://www.soft263.com/dev/PowerTask/PowerTask.ps1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或者</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iex (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">new-object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> net.webclient).downloadstring(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https://raw.githubusercontent.com/cylin2000/powertask/master/PowerTask.ps1?t=&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Get-Random</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><p>系统出现以下界面代表载入成功</p><p><img src="https://images.caiyunlin.com/20200326043852.png" alt="image"></p><h2 id="获取使用帮助" tabindex="-1">获取使用帮助 <a class="header-anchor" href="#获取使用帮助" aria-label="Permalink to &quot;获取使用帮助&quot;">​</a></h2><p>比如我们要使用 Get-StringHash , 这是个字符串加密工具，可以使用标准的powershell命令<code>Get-Help Get-StringHash</code>查询使用帮助</p><p><img src="https://images.caiyunlin.com/20200326044535.png" alt="image"></p><p>执行 Get-StringHash 获得 MD5 编码</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PS C:\\Users\\ycai8</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Get-StringHash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;abc&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">900150983cd24fb0d6963f7d28e17f72</span></span></code></pre></div><h2 id="功能简介" tabindex="-1">功能简介 <a class="header-anchor" href="#功能简介" aria-label="Permalink to &quot;功能简介&quot;">​</a></h2><p>PowerTask 目前包含的功能还不是很多，但是在不断完善中，下面是一个简要的介绍</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Add-FtpFile</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # 上传文件到FTP服务器</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Compress-Zip</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # 压缩 Zip 文件</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Expand-Zip</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 解压 Zip 文件</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Get-DoubanMovieRate</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 获取电影的豆瓣评分(调用的豆瓣API)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Get-FtpFile</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # 下载FTP文件</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Get-InstalledSoftware</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 获取本地安装的软件清单</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Get-Software</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # 下载在线软件</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Get-StringHash</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         # 获取文本的加密编码</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Get-WebContent</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         # 获取Web地址的文本内容，类似于 wget</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Get-WebFile</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # 下载Web地址的文件</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Install-PowerTask</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 安装PowerTask到本地</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Install-Software</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       # 安装在线软件</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Invoke-Batch</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # 调用本地bat文件</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Invoke-FlashWindow</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     # 调用闪屏窗口</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Invoke-Sql</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 执行本地SQL脚本</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">New-RandomPassword</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     # 生成一个随机密码</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Send-Sms</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 发送短信(使用webchinese接口)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Set-TaskbarProgress</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 设置Taskbar进度条</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Show-BalloonTip</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 显示桌面右下角气泡提示</span></span></code></pre></div><p>【全文完】</p>`,18)])])}const c=i(l,[["render",t]]);export{g as __pageData,c as default};
